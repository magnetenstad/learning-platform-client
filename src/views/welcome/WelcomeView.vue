<template>
  <div class="row spaced" style="justify-content: end; gap: 1em">
    <span v-if="userStore.user">{{ userStore.user.email }}</span>
    <button v-if="!userStore.user" @click="userStore.signIn">Sign In</button>
    <button v-else @click="userStore.signOut">Sign out</button>
  </div>
  <h1>Welcome to Utdyp ðŸ¦‰</h1>
  <div class="col">
    <label for="name">I would like to learn about</label>
    <input id="name" type="text" v-model="subject" />
    <br />
    <label for="author-options">Questions should be</label>
    <RadioButtons
      id="author-options"
      name="author-options"
      :buttons="[
        { value: 'ai', label: 'generated by AI' },
        { value: 'user', label: 'written by me' },
      ]"
      @input="optionInput"
    ></RadioButtons>
    <br />
    <div>
      <button :disabled="submitDisabled" @click="submit">Submit</button>
    </div>
    <br />
    <span
      >Experimental:
      <router-link to="/bookshelf">browse bookshelf</router-link></span
    >
  </div>
</template>

<script lang="ts" setup>
import RadioButtons, { RadioButton } from '@/components/RadioButtons.vue'
import { RouterLink } from 'vue-router'
import { router } from '@/router'
import { ref, computed } from 'vue'
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()

const subject = ref('')
const option = ref('')

const optionInput = (button: RadioButton) => {
  option.value = button.value
}

const submitDisabled = computed(() => !option.value || !subject.value)

const submit = () => {
  if (option.value == 'ai') {
    router.push({ name: 'quiz', query: { subject: subject.value } })
    return
  }
  if (option.value == 'user') {
    router.push({ name: 'edit', query: { subject: subject.value } })
  }
}
</script>

<style scoped>
label {
  margin: 1em 0 1em;
}
</style>
